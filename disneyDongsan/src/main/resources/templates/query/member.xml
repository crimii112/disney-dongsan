<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.disney.client.dao.MemberDAO">
	
	<!-- 로그인 처리 -->
	<select id="login" parameterType="member" resultType="member">
		SELECT member_id memberId, member_passwd memberPasswd, member_name memberName, member_phone memberPhone, member_email memberEmail, member_addr1 memberAddr1, member_addr2 memberAddr2, member_addr3 memberAddr3, member_regdate memberRegdate, member_state memberState
		FROM member
		WHERE member_id = #{memberId} AND member_passwd = #{memberPasswd}
	</select>
	
	<!-- 아이디 찾기 처리 -->
	<select id="findId" parameterType="member" resultType="member">
		SELECT member_id memberId, member_regdate memberRegdate
		FROM member
		WHERE member_name = #{memberName} AND member_phone = #{memberPhone}
	</select>
	
	<!-- 회원가입 : 아이디 중복 확인 -->
	<select id="idCheck" parameterType="member" resultType="int">
		SELECT NVL((SELECT 1 FROM member WHERE member_id=#{memberId}), 0) AS result
		FROM dual
	</select>
	
	<!-- 회원가입 -->
	<insert id="signup" parameterType="member">
		INSERT INTO member
		VALUES(#{memberId}, #{memberPasswd}, #{memberName}, #{memberPhone}, #{memberEmail}, #{memberAddr1}, #{memberAddr2}, #{memberAddr3}, SYSDATE, NULL)
	</insert>
	
	<!-- 탈퇴 회원 상태 변경 -->
	<update id="withdrawal" parameterType="member">
		UPDATE member
		SET member_state = '탈퇴'
		WHERE member_id = #{memberId}
	</update>
</mapper>